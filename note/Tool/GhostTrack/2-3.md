# ç¬¬2ç« ï¼šèœå•ä¸é€‰é¡¹ç®¡ç†ç³»ç»Ÿ

åœ¨`GhostTrack`å·¥å…·ä¸­ï¼Œèœå•ç³»ç»Ÿå¦‚åŒæ™ºèƒ½å¯¼èˆªä¸­æ¢ï¼Œé€šè¿‡ç²¾å¿ƒè®¾è®¡çš„æ¶æ„å®ç°åŠŸèƒ½è°ƒåº¦ã€‚æœ¬ç« å°†æ·±å…¥è§£æå…¶å®ç°åŸç†ä¸æŠ€æœ¯ç»†èŠ‚ã€‚

## æ ¸å¿ƒæ•°æ®ç»“æ„

### é€‰é¡¹æ³¨å†Œè¡¨
```python
options = [
    {
        'num': 1,                   # é€‰é¡¹ç¼–å·
        'text': 'IPåœ°å€è¿½è¸ª',       # æ˜¾ç¤ºæ–‡æœ¬
        'func': IP_Track            # ç»‘å®šå‡½æ•°
    },
    {
        'num': 2,
        'text': 'æ˜¾ç¤ºæœ¬æœºIP',
        'func': showIP
    },
    # ...å…¶ä»–é€‰é¡¹...
    {
        'num': 0,
        'text': 'é€€å‡ºç¨‹åº',
        'func': exit
    }
]
```

## æŠ€æœ¯å®ç°

### èœå•æ¸²æŸ“å¼•æ“
```python
def option_text():
    """åŠ¨æ€ç”Ÿæˆèœå•æ–‡æœ¬"""
    menu_str = ''
    for item in options:
        menu_str += f'{Wh}[ {item["num"]} ] {Gr}{item["text"]}\n'
    return menu_str

def option():
    """ä¸»ç•Œé¢æ¸²æŸ“å‡½æ•°"""
    clear()  # æ¸…å±æ“ä½œ
    # æ˜¾ç¤ºASCIIè‰ºæœ¯æ¨ªå¹…
    stderr.writelines(option_text())  # è¾“å‡ºæ ¼å¼åŒ–èœå•
```

### é€‰é¡¹è°ƒåº¦å™¨
```python
def call_option(selected_num):
    """é€‰é¡¹æ‰§è¡Œè·¯ç”±"""
    if selected_num not in [opt['num'] for opt in options]:
        raise ValueError('æ— æ•ˆé€‰é¡¹ç¼–å·')
    
    for item in options:
        if item['num'] == selected_num:
            item['func']()  # æ‰§è¡Œç»‘å®šå‡½æ•°
            return
```

### è‡ªåŠ¨åŒ–æ¨ªå¹…è£…é¥°å™¨
```python
def is_option(func):
    """å‡½æ•°è£…é¥°å™¨ï¼šè‡ªåŠ¨æ·»åŠ æ¨ªå¹…"""
    def wrapper(*args, **kwargs):
        run_banner()  # å‰ç½®æ¨ªå¹…æ˜¾ç¤º
        func(*args, **kwargs)  # æ‰§è¡ŒåŸå‡½æ•°
    return wrapper

@is_option  # åº”ç”¨è£…é¥°å™¨
def IP_Track():
    """IPè¿½è¸ªåŠŸèƒ½å®ç°"""
    target_ip = input(f"{Wh}\n è¾“å…¥ç›®æ ‡IP : {Gr}")
    # ...IPæŸ¥è¯¢é€»è¾‘...
```

##### ğŸ¢è£…é¥°å™¨è®¾è®¡å“²å­¦

å¯ä»¥è§£é‡Šä¸ºï¼š

**â€œåœ¨ä¸ä¿®æ”¹åŸå‡½æ•°ä»£ç çš„å‰æä¸‹ï¼Œç»Ÿä¸€ç»™å¤šä¸ªåŠŸèƒ½==è‡ªåŠ¨åŠ ä¸Šç›¸åŒçš„å‰ç½®æ“ä½œ==ï¼ˆæ¯”å¦‚æ˜¾ç¤ºæ¨ªå¹…ï¼‰ã€‚â€**

å°±åƒä½ æ¯æ¬¡è¿›æ•™å®¤å‰ï¼Œè€å¸ˆéƒ½è¦æ±‚å–Šä¸€å£°â€œæŠ¥å‘Šâ€â€”â€”è£…é¥°å™¨å°±æ˜¯é‚£ä¸ª==è‡ªåŠ¨å¸®ä½ å–Šâ€œæŠ¥å‘Šâ€==çš„è§„åˆ™ï¼Œä½ åªç®¡è¿›æ•™å®¤ï¼ˆå†™è‡ªå·±çš„åŠŸèƒ½ï¼‰ï¼Œä¸ç”¨æ¯æ¬¡éƒ½æ‰‹åŠ¨å–Š

## ç³»ç»Ÿå·¥ä½œæµç¨‹

```mermaid
sequenceDiagram
    ç”¨æˆ·->>ä¸»å¾ªç¯: å¯åŠ¨ç¨‹åº
    ä¸»å¾ªç¯->>èœå•ç³»ç»Ÿ: è°ƒç”¨option()
    èœå•ç³»ç»Ÿ->>ç”¨æˆ·: æ˜¾ç¤ºæ¬¢è¿æ¨ªå¹…+é€‰é¡¹åˆ—è¡¨
    ç”¨æˆ·->>ä¸»å¾ªç¯: è¾“å…¥é€‰é¡¹ç¼–å·
    ä¸»å¾ªç¯->>è°ƒåº¦å™¨: æ‰§è¡Œcall_option()
    è°ƒåº¦å™¨->>è£…é¥°å™¨: è§¦å‘@is_option
    è£…é¥°å™¨->>ç”¨æˆ·: æ˜¾ç¤ºå·¥å…·ä¸“å±æ¨ªå¹…
    è£…é¥°å™¨->>åŠŸèƒ½æ¨¡å—: æ‰§è¡Œå®é™…åŠŸèƒ½
    åŠŸèƒ½æ¨¡å—->>ç”¨æˆ·: è¾“å‡ºç»“æœ
    ç”¨æˆ·->>ä¸»å¾ªç¯: å›è½¦è¿”å›
```

## è®¾è®¡ä¼˜åŠ¿åˆ†æ

1. **å¯æ‰©å±•æ¶æ„**
   - æ–°å¢åŠŸèƒ½åªéœ€åœ¨`options`åˆ—è¡¨æ³¨å†Œ
   - ç¬¦åˆå¼€é—­åŸåˆ™(OCP)

2. **ä¸€è‡´æ€§ä¿éšœ**
   - è£…é¥°å™¨æ¨¡å¼ç¡®ä¿ç»Ÿä¸€çš„å‰ç½®æ¨ªå¹…
   - èœå•è‡ªåŠ¨ç”Ÿæˆé¿å…ç¡¬ç¼–ç 

3. **å¼‚å¸¸å¤„ç†**
   - è¾“å…¥éªŒè¯æœºåˆ¶
   - é”™è¯¯ç¼–å·æ£€æµ‹

## æ€§èƒ½è€ƒé‡

1. **æ—¶é—´å¤æ‚åº¦**
   - èœå•æ¸²æŸ“: O(n)
   - é€‰é¡¹æŸ¥æ‰¾: O(n) â†’ å¯ä¼˜åŒ–ä¸ºå­—å…¸O(1)

2. **å†…å­˜å ç”¨**
   - é€‰é¡¹åˆ—è¡¨å¸¸é©»å†…å­˜
   - æ¨ªå¹…æ–‡æœ¬æŒ‰éœ€åŠ è½½

## å®è·µå»ºè®®

1. **å›½é™…åŒ–æ”¯æŒ**
   ```python
   # å¤šè¯­è¨€æ‰©å±•ç¤ºä¾‹
   options = [
       {
           'num': 1,
           'text': {'en': 'IP Tracker', 'zh': 'IPåœ°å€è¿½è¸ª'},
           'func': IP_Track
       }
   ]
   ```

2. **çƒ­é‡è½½æœºåˆ¶**
   ```python
   def reload_options():
       global options
       options = load_from_config('menu_config.json')
   ```

æ¥ä¸‹æ¥å°†æ·±å…¥é¦–ä¸ªåŠŸèƒ½æ¨¡å—çš„å®ç°ç»†èŠ‚ï¼š
[ç¬¬3ç« ï¼šIPåœ°å€è¿½è¸ªå™¨](03_ip_address_tracker_.md)

---
# ç¬¬3ç« ï¼šIPåœ°å€è¿½è¸ªå™¨

åœ¨`GhostTrack`å·¥å…·ä¸­ï¼ŒIPåœ°å€è¿½è¸ªæ¨¡å—é€šè¿‡æ™ºèƒ½åŒ–çš„ç½‘ç»œè¯·æ±‚ä¸æ•°æ®å¤„ç†ï¼Œå®ç°äº†å¯¹ç›®æ ‡IPçš„æ·±åº¦ä¿¡æ¯æŒ–æ˜ã€‚æœ¬ç« å°†å…¨é¢è§£æå…¶æŠ€æœ¯å®ç°ä¸è¿è¡Œæœºåˆ¶ã€‚

## åŠŸèƒ½æ¦‚è¿°

### æ ¸å¿ƒèƒ½åŠ›

![image-20251110110438845](image-20251110110438845.png)

- **åœ°ç†å®šä½**ï¼šè§£æIPæ‰€å±å›½å®¶/åŸå¸‚
- **ç½‘ç»œå½’å±**ï¼šè¯†åˆ«ISPæœåŠ¡å•†
- **æ—¶åŒºä¿¡æ¯**ï¼šè·å–å½“åœ°æ ‡å‡†æ—¶é—´
- **ç½‘ç»œå±æ€§**ï¼šåˆ¤æ–­IPç±»å‹(IPv4/IPv6)

### åº”ç”¨åœºæ™¯
1. ç½‘ç»œæµé‡æ¥æºåˆ†æ
2. æœåŠ¡å™¨ä½ç½®éªŒè¯
3. å¯ç–‘è¿æ¥è°ƒæŸ¥
4. ç½‘ç»œæ‹“æ‰‘ç ”ç©¶

## æŠ€æœ¯å®ç°

### æ ¸å¿ƒå‡½æ•°ç»“æ„
```python
@is_option  # è‡ªåŠ¨åŠ è½½æ¨ªå¹…è£…é¥°å™¨
def IP_Track():
    target_ip = input(f"{Wh}\n è¾“å…¥ç›®æ ‡IP : {Gr}")  # ç”¨æˆ·è¾“å…¥æ•è·
    print(f' {Wh}============= {Gr}IPåœ°å€è¯¦ç»†ä¿¡æ¯ {Wh}=============')
    
    # APIè¯·æ±‚ä¸æ•°æ®å¤„ç†
    response = requests.get(f"http://ipwho.is/{target_ip}")
    ip_data = json.loads(response.text)
    
    # ä¿¡æ¯æå–ä¸å±•ç¤º
    print(f"{Wh}\n IPç›®æ ‡åœ°å€   :{Gr}", target_ip)
    print(f"{Wh} IPç±»å‹       :{Gr}", ip_data["type"])
    print(f"{Wh} å›½å®¶         :{Gr}", ip_data["country"])
    # ...æ›´å¤šå­—æ®µè¾“å‡º...
    
    # åœ°å›¾é“¾æ¥ç”Ÿæˆ
    map_url = f"https://www.google.com/maps/@{int(ip_data['latitude'])},{int(ip_data['longitude'])},8z"
    print(f"{Wh} åœ°å›¾ä½ç½®     :{Gr}", map_url)
```

### æŠ€æœ¯ç‚¹

1. **APIé›†æˆ**
   - é‡‡ç”¨`ipwho.is`å…è´¹APIæœåŠ¡
   - ==è¯·æ±‚æ ¼å¼: `http://ipwho.is/{ip_address}`==
   - å“åº”æ•°æ®: JSONæ ¼å¼

2. **æ•°æ®å¤„ç†**
   ```python
   {
       "ip": "8.8.8.8",
       "type": "IPv4",
       "country": "United States",
       "city": "Ashburn",
       "latitude": 39.03,
       "longitude": -77.5,
       # ...å…¶ä»–å­—æ®µ...
   }
   ```

3. **ç”¨æˆ·ä½“éªŒä¼˜åŒ–**
   - å½©è‰²ç»ˆç«¯è¾“å‡º
   - 2ç§’å»¶è¿Ÿæ¨¡æ‹Ÿæ•°æ®å¤„ç†è¿‡ç¨‹
   - ç›´æ¥ç”Ÿæˆå¯ç‚¹å‡»çš„åœ°å›¾é“¾æ¥

## ç³»ç»Ÿæ¶æ„

```mermaid
sequenceDiagram
    ç”¨æˆ·->>å‰ç«¯ç•Œé¢: è¾“å…¥ç›®æ ‡IP
    å‰ç«¯ç•Œé¢->>APIç½‘å…³: å‘èµ·æŸ¥è¯¢è¯·æ±‚
    APIç½‘å…³->>æ•°æ®åº“é›†ç¾¤: æ£€ç´¢IPä¿¡æ¯
    æ•°æ®åº“é›†ç¾¤-->>APIç½‘å…³: è¿”å›åŸå§‹æ•°æ®
    APIç½‘å…³-->>å‰ç«¯ç•Œé¢: è¿”å›JSONå“åº”
    å‰ç«¯ç•Œé¢->>æ•°æ®å¤„ç†å™¨: è§£æJSON
    æ•°æ®å¤„ç†å™¨->>ç»“æœæ¸²æŸ“å™¨: ç»“æ„åŒ–æ•°æ®
    ç»“æœæ¸²æŸ“å™¨->>ç”¨æˆ·: æ ¼å¼åŒ–è¾“å‡º
```

## å®‰å…¨ä¸é™åˆ¶

1. **éšç§ä¿æŠ¤**
   - ä»…æŸ¥è¯¢å…¬å¼€æ³¨å†Œçš„IPä¿¡æ¯
   - ä¸è®°å½•ç”¨æˆ·æŸ¥è¯¢å†å²

2. **ä½¿ç”¨é™åˆ¶**
   - å…è´¹APIçš„è¯·æ±‚é¢‘ç‡é™åˆ¶(60æ¬¡/åˆ†é’Ÿ)
   - éƒ¨åˆ†å­—æ®µå¯èƒ½ç¼ºå¤±(å¦‚åŸå¸‚çº§ç²¾åº¦)

3. **æ•°æ®å‡†ç¡®æ€§**
   - ISPä¿¡æ¯å¯èƒ½å­˜åœ¨å»¶è¿Ÿæ›´æ–°
   - åœ°ç†åæ ‡ä¸ºå¤§èŒƒå›´è¿‘ä¼¼å€¼

## æ‰©å±•åº”ç”¨

### æ‰¹é‡æŸ¥è¯¢æ¨¡å¼
```python
def batch_ip_track(ip_list):
    results = []
    for ip in ip_list:
        res = requests.get(f"http://ipwho.is/{ip}")
        results.append(json.loads(res.text))
    return pd.DataFrame(results)  # è¿”å›DataFrameä¾¿äºåˆ†æ
```

### å¼‚å¸¸æ£€æµ‹
```python
def detect_anomaly(ip_data):
    if ip_data['proxy'] or ip_data['tor']:
        return "åŒ¿åç½‘ç»œè­¦å‘Š"
    if ip_data['latitude'] == 0:  # æ— æ•ˆåæ ‡
        return "æ•°æ®å¼‚å¸¸"
    return None
```

## æ€§èƒ½ä¼˜åŒ–

1. **ç¼“å­˜æœºåˆ¶**
   ```python
   from functools import lru_cache
   
   @lru_cache(maxsize=100)
   def cached_ip_lookup(ip):
       return requests.get(f"http://ipwho.is/{ip}")
   ```

2. **å¼‚æ­¥è¯·æ±‚**
   ```python
   import aiohttp
   
   async def async_ip_track(ip):
       async with aiohttp.ClientSession() as session:
           async with session.get(f"http://ipwho.is/{ip}") as response:
               return await response.json()
   ```

æ¥ä¸‹æ¥å°†æ¢ç´¢é€šä¿¡æ ‡è¯†è§£ææŠ€æœ¯ï¼š
[ç¬¬4ç« ï¼šç”µè¯å·ç åˆ†æå™¨](04_phone_number_analyzer_.md)

