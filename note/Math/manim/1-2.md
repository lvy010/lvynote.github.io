# 第1章：数学对象(Mobject)

欢迎来到Manim

本章我们将认识最基础的概念——`Mobject`。你可以将`Mobject`视为Manim动画中的"演员"或"道具"。屏幕上看到的一切元素，从简单的圆点到复杂的图表、文字甚至3D曲面，都是`Mobject`或其派生对象。

## Mobject的核心价值

想象你在导演一部舞台剧，需要安排演员站位、服装颜色和台词。在Manim中，`Mobject`就是为所有视觉元素提供基础指令的基类。它通过统一的数据结构解决图形渲染问题——无论是绘制方形、文字还是线条，所有视觉元素都继承自`Mobject`基类，共享变换、组合和动画等核心能力。

## Mobject的本质

`Mobject`是"Mathematical Object"的缩写，作为Python对象存储着屏幕绘制所需的全部信息：

* **空间属性**：三维坐标位置
* **视觉样式**：颜色值(RGBA)、透明度
* **几何数据**：形状定义(如圆的曲线方程或方形的顶点坐标)

==所有Manim视觉元素都继承自`Mobject`==。例如`Circle`圆形、`Square`方形、`Text`文本都是特定类型的`Mobject`。

### 核心能力
每个`Mobject`都可以：
- **组合**：多个对象聚合成组(如将树木组合为森林)
- **变换**：移动/旋转/缩放等几何变换
- **动态更新**：随时间改变属性(如追踪移动的点)

## 创建第一个Mobject

![https://cdn.jsdelivr.net/gh/manim-kindergarten/CDN@master/manimgl_assets/quickstart/SquareToCircle.png](https://cdn.jsdelivr.net/gh/manim-kindergarten/CDN@master/manimgl_assets/quickstart/SquareToCircle.png)

以创建蓝色圆形为例，Manim提供了现成的`Circle`类(属于`VMobject`矢量对象)：

```python
from manimlib.mobject.geometry import Circle
from manimlib.constants import BLUE

# 创建默认圆形(半径1单位，位于原点)
my_circle = Circle()
my_circle.set_color(BLUE)  # 设置为蓝色

# 创建时直接指定属性
another_circle = Circle(radius=0.5, color=RED)
```

## 底层数据结构

所有`Mobject`都使用`self.data`这个numpy数组存储信息，其数据结构通过继承体系层层增强：

1. **基础层(Mobject)**  
   定义基础字段：三维坐标`point`和颜色`rgba`
   ```python
   class Mobject:
       data_dtype = [
           ('point', 'float32', (3,)),  # x,y,z坐标
           ('rgba', 'float32', (4,))    # 颜色+透明度
       ]
   ```

2. **矢量层(VMobject)**  
   扩展图形专属字段：
   
   ```python
   class VMobject(Mobject):
       data_dtype = [
           ('stroke_rgba', 'float32', (4,)),  # 描边颜色
           ('fill_rgba', 'float32', (4,)),    # 填充颜色
           ('stroke_width', 'float32')         # 线宽
       ]
   ```
   
3. **应用层(Circle)**  
   计算贝塞尔曲线点集并存入数据结构：
   ```python
   class Circle(VMobject):
       def __init__(self):
           points = calculate_bezier_points()  # 数学计算
           self.set_points(points)  # 存入self.data
   ```

## Mobject类型对比

| 特性         | 基础Mobject          | 矢量VMobject                     |
| ------------ | -------------------- | -------------------------------- |
| **用途**     | 所有视觉元素的基类   | 专用于矢量图形(由数学曲线定义)   |
| **典型类**   | Group, PointCloud    | Circle, Text, Polygon            |
| **数据字段** | ==仅基础坐标和颜色== | ==增加描边、填充等图形专属属性== |
| **使用频率** | 较少直接实例化       | 主要工作对象                     |

本章我们学会了创建`Mobject`，但要让其显示还需了解[场景系统](02_scene_.md)——这是控制动画舞台的核心组件。

[下一章：场景系统](02_scene_.md)

------

# 第2章：场景系统

在[上一章](01_mobject__mathematical_object__.md)中，我们学习了`Mobject`——构成Manim动画的基本元素。

我们掌握了如何创建`Circle`这样的`Mobject`并设置其颜色，但尚未让这些图形真正显示在屏幕上。

这正是`Scene`（场景）的用武之地。

## 场景的核心作用：动画舞台

想象你在导演一部舞台剧。已有演员（`Mobject`）和道具，但表演需要舞台！在Manim中，`Scene`就是这个舞台，是动画呈现的主画布。它解决了以下关键问题：
- **元素管理**：控制哪些`Mobject`可见
- **时序编排**：决定元素何时出现、移动或变化
- **渲染输出**：将逐帧动画合成为最终视频

没有`Scene`，`Mobject`只是内存中的抽象对象。场景系统是将代码转化为视觉叙事的核心枢纽。

## 场景的本质

`Scene`是一个继承自Python类的动画导演。运行Manim脚本时，系统会自动寻找继承`Scene`的类并执行其`construct`方法。这个方法是动画的"剧本"，包含所有视觉指令。

### 核心方法
| 方法                 | 作用                     | 示例                     |
| -------------------- | ------------------------ | ------------------------ |
| `construct(self)`    | **必需** 编写动画逻辑    | `def construct(self):`   |
| `self.add(*mobs)`    | 立即添加元素到场景       | `self.add(circle)`       |
| `self.remove(*mobs)` | 立即移除场景元素         | `self.remove(square)`    |
| `self.play(*anims)`  | 播放动画效果（详见下章） | `self.play(Create(dot))` |
| `self.wait(sec)`     | 暂停指定秒数             | `self.wait(1.5)`         |

## 第一个场景实例

让我们实现上章的蓝色圆形显示：

```python
from manimlib.scene.scene import Scene
from manimlib.mobject.geometry import Circle
from manimlib.constants import BLUE
from manimlib.animation.creation import Create  # 用于创建动画

class BlueCircleScene(Scene):
    def construct(self):
        # 创建蓝色圆形
        circle = Circle(color=BLUE)
        
        # 播放创建动画
        self.play(Create(circle))
        
        # 停留2秒
        self.wait(2)
```

**运行命令**：
```bash
manimgl my_scene.py BlueCircleScene -p
```
参数说明：
- `-p` 预览动画
- `-w` 保存为视频文件

执行后将看到蓝色圆形逐渐绘制的动画，持续2秒后关闭窗口。

## 场景运作机制

### 生命周期流程
1. **初始化阶段**  
   - 创建`Camera`摄像机（负责画面捕捉）
   - 初始化`SceneFileWriter`视频写入器
   - 准备`self.mobjects`列表（存储当前可见元素）

2. **执行阶段**  
   ```mermaid
   sequenceDiagram
       participant CLI as 命令行
       participant Scene as 场景实例
       CLI->>Scene: 执行run()
       Scene->>Scene: 初始化摄像机/写入器
       Scene->>Scene: 调用construct()
       Scene->>Scene: 添加圆形并播放动画
       loop 每帧处理
           Scene->>Scene: 更新元素状态
           Scene->>Camera: 捕捉当前帧
           Camera->>FileWriter: 写入帧数据
       end
       Scene->>CLI: 完成渲染
   ```

3. **动画处理**  
   `self.play()`调用时：
   - 计算动画起止间的中间帧
   - 每帧更新元素属性（位置/颜色等）
   - 调用摄像机捕捉当前画面

### 代码结构
```python
class Scene:
    def __init__(self):
        self.camera = Camera()          # 画面捕捉
        self.file_writer = FileWriter() # 视频输出
        self.mobjects = []              # 可见元素列表

    def play(self, *animations):
        for frame in animation_frames:
            self.update_elements()      # 更新元素状态
            self.camera.capture()       # 拍摄当前帧
            self.file_writer.write()    # 写入帧数据
```

## 下章

现在已掌握静态元素展示，接下来将学习[动画系统](03_animation_.md)，让元素动起来

[下一章：动画系统](03_animation_.md)

